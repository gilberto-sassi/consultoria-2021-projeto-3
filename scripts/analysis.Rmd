---
title: "Análises"
output: bookdown::html_notebook2
editor_options: 
  chunk_output_type: console
---

# Used packages

```{r, message=FALSE}
library(readr)
library(readxl)
library(openxlsx)
library(stringr)
library(tidyverse)

# options to chunks
knitr::opts_chunk$set(echo = FALSE, out.width = "50%", fig.align = "center")

# setting theme
theme_set(theme_minimal())

# path directory
output <- stringr::str_interp('/home/gilberto/Dropbox/UFBA/consultoria/2021/consultoria-jualiana-adriana/output/')

# loading data
dados <- read_xlsx("/home/gilberto/Dropbox/UFBA/consultoria/2021/consultoria-jualiana-adriana/data/raw/Banco de dados atualizado15-03-211.xlsx")

source("/home/gilberto/Dropbox/UFBA/consultoria/2021/consultoria-jualiana-adriana/scripts/tabela_grafico.R")

df <- dados |> 
  dplyr::mutate_at(dplyr::vars(dplyr::matches("^Q[4-6]$")), \(x) dplyr::recode(x,
                                                      `0` = 'Não',
                                                      `1` = 'Sim',
                                                      `2` = 'Não sei')) |> 
  dplyr::mutate_at(paste0("Q", 7:22), \(x) dplyr::recode(x,
                                       `0` = 'Sem preocupação',
                                       `1` = 'Pouca preocupação',
                                       `2` = 'Muita preocupação',
                                       `3` = 'Sem resposta'))
```

# Initial unidimensional analysis

## Cidade

### Bar graph

```{r}
grafico(dados, 'Cidade', 'Cidade')
```

### Distribution table

```{r}
tabela(dados, 'Cidade', 'Cidade', "Tabela de distribuição de frequências para variável Cidade.", base = output)
```

## Tipo de escola

### Bar graph

```{r}
grafico(dados, 'Escola', "Tipo de Escola")
```

### Distribution table

```{r}
tabela(dados, 'Escola', 'Tipo de Escola', "Tabela de distribuição de frequências para Tipo de Escola.", base = output)
```

## Gênero

### Distribuition tabela

```{r}
tabela(dados, 'Gênero', 'Gênero', 'Tabela de distribuição de frequências para Gênero', base = output)
```

### Bar graph

```{r}
grafico(dados, 'Gênero', 'Gênero')
```

## Idade

### Distribution table

```{r}
tabela(dados, 'Idade', 'Idade', 'Tabela de distribuição para Idade.', base = output)
```

### Bar graph

```{r}
grafico(dados, 'Idade', 'Idade')
```

## Raça

I have collapse `Negra`, `Parda` and `Preta` into `Negra`.

### Distribution table

```{r}
dados <- dados |> 
  mutate(raca = raça |>
           recode('Não sei responder ou não quero responder' = 'Sem resposta',
                  'Parda' = 'Negra',
                  'Preta' = 'Negra'))
tabela(dados, 'raca', 'Raça','Tabela de distribuição para Raça.', base = output)
```

### Bar graph

```{r}
grafico(dados, 'raca', 'Raça')
```

# Bidimensional analysis

## Questão 12

In the dataset it refers to the following questions:

Q14) a Q22)

and we have used _linkert_ scale:


* 0 - Não estou preocupado (a)
* 1 - Estou um pouco preocupado (a)
* 2 - Estou muito preocupado (a)
* 3 - Não sei ou não quero responder

### Q14)

#### Resume measures

```{r}

tabela(df, 'Q14', 'Q14', 'Você está preocupado com minha família e meus amigos fiquem mais pobres, com menos dinheiro ou sem emprego?', base = output)
```

### Bar graph

```{r}

```


